"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.vm = void 0;
const fs_1 = __importDefault(require("fs"));
const path_1 = __importDefault(require("path"));
const virtual_modules_1 = __importDefault(require("virtual_modules"));
exports.vm = virtual_modules_1.default;
const dirname = path_1.default.dirname(__dirname);
const modules = path_1.default.dirname(dirname);
const iconModule = virtual_modules_1.default.resolveModule('boxicons', modules);
const handle = (filename, res) => {
    if (!/\.js$/.test(filename) || res.body) {
        return;
    }
    const { params } = virtual_modules_1.default.routeParams(filename, `/**/:type/:name`);
    const type = params.type.toLowerCase();
    const name = params.name.substr(0, params.name.length - 3);
    let prefix = 'bx';
    if (type === 'logos')
        prefix += 'l';
    if (type === 'solid')
        prefix += 's';
    let svg = null;
    try {
        svg = fs_1.default.readFileSync(`${iconModule}/svg/${type}/${prefix}-${name.toLowerCase()}.svg`).toString('utf8');
    }
    catch (e) {
        return;
    }
    svg = svg.replace(/width="[0-9]*"/, 'width={size}');
    svg = svg.replace(/height="[0-9]*"/, 'height={size}');
    svg = svg.replace('<svg', '<svg className={className} style={style}');
    res.write(`export default function BoxIcon(props) {
      const { className, style, size } = props 
      return ${svg} 
    }`);
};
virtual_modules_1.default.route(`${dirname}/icons/:type/:name`, handle);
virtual_modules_1.default.route(`/**/node_modules/react-boxicons/:type/:name`, handle);
virtual_modules_1.default.route(`/**/react-boxicons/:type/:name`, handle);
virtual_modules_1.default.patchFS();
